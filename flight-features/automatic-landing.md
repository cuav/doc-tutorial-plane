## 自动着陆

---

这篇文章解释了如何将飞机降落作为任务计划的一部分，并且包括如何安全着陆的信息。

## 配置自动着陆

飞机可以自动降落飞机，作为任务计划的一部分。

要使飞机着陆，需要在任务结束时添加一个NAV\_LAND命令，指示所需着陆点的纬度，经度和高度。在大多数情况下，高度应设置为0.在着陆期间，当飞机到达熄火点时，自动驾驶仪将关闭油门并保持当前航向，由下述参数控制。

关键参数

控制自动着陆的关键参数是：

LAND\_FLARE\_ALT

LAND\_FLARE\_SEC

LAND\_PITCH\_CD

TECS\_LAND\_ARSPD

TECS\_LAND\_SPDWGT

下面介绍每个参数的含义和建议值。

设置flare点

“flare”是当自动驾驶仪切断油门并提高倾斜度时，着陆的最后阶段，增加阻力并放慢飞机沉入地面。适当的flare时间取决于飞机的类型，并由LAND\_FLARE\_ALT和LAND\_FLARE\_SEC参数控制。

flare的主要控制是LAND\_FLARE\_SEC参数。如果飞机继续以当前的下降速度继续飞行，那么这是几秒钟之前的时间。所以，如果飞机以2米/秒的速度下降，并且将LAND\_FLARE\_SEC设置为3，则飞机将在地面以上6米的高度发射。通过使用一段时间冲击来控制flare，如果飞机快速下降，则飞机能够在更高的高度发射;如果飞机缓慢下降，则可以在更低的高度发射。这有助于确保flare能够产生平稳的触地。

第二个控件是LAND\_FLARE\_ALT。无论飞机的下降速度如何，这个高度都是以米为单位的高度。

这两个参数的适当值取决于自动驾驶仪如何估算其高度在地面以上。如果自动驾驶仪有一个很好的测距仪（如激光雷达），那么你可以安全地选择相当小的数字，并接近地面熄火。这通常会产生更好的着陆。 LAND\_FLARE\_SEC为1.5，LAND\_FLARE\_ALT为2的值是以LiDAR开始的好地方。如果仅仅依靠气压计着陆高度，则可能需要更高的值才能解释气压误差。

### 控制滑翔坡度

设置flare点的另一个重要因素是下滑道。滑翔坡度是从最后一个航点到着陆点的距离与最后航点和着陆点之间的高度差的比率。例如，如果着陆点距离最后一个航点300米，最后一个航点是地面30米，那么滑翔斜率为10％。

如果滑翔坡度太陡，那么飞机将不能及时发亮以避免撞击，加上自动驾驶仪可能无法准确地将飞机保持在进近坡道上。建议您以最多10％的下滑坡度开始。您的飞机能够处理的下滑坡度取决于您的俯仰控制器的调校能力，您的TECS调校的效果以及您要求的着陆速度。

如果您发现您的飞机没有准确地跟踪所需的滑行坡度，那么您应该首先检查您的日志中的俯仰调整，并确保在着陆过程中要求的和实现的音高在几度之内匹配。如果他们没有看到音调调整文档（或者可能需要重新运行AUTOTUNE）。如果要求和达到的pitch匹配，那么你应该检查你的TECS记录，以确保在着陆过程中要求和达到的空速相匹配。查看TECS调整补丁以获取更多信息。

你也应该知道，很多模型飞机可以长距离滑行，也可能是你所要求的滑翔坡度和空速组合不可能实现。

### 着陆空速

自动着陆通过使用空速传感器得到极大的帮助。使用空速传感器时，着陆进场速度（下滑速度）由TECS\_LAND\_ARSPD参数控制，单位为米/秒。

您需要为TECS\_LAND\_ARSPD选择高于您的飞机失速速度的值，但要足够低以使飞机能够在合理的距离内降低高度并降落。请注意，由于失速速度取决于您的飞机的重量，如果您显着改变飞机的重量（例如添加电池或摄像头），则需要调整降落速度。

为了进一步改善着陆，您可以使用预扩张来在发生火光之前降低空速。这可以通过设置LAND\_PF\_ALT或LAND\_PF\_SEC来进入一个固定高度的预闪光状态，或者估计到地面的秒数（考虑到你现在正常的速率）。一旦Pre-Flare被触发，所需的空速变为LAND\_PF\_ARSPD。该值应该低于TECS\_LAND\_ARSPD，但大于失速速度。在反向推力可用的情况下，这一点特别有用。然而，一些飞机可以处理失速降落，所以将其设置为非常低的数字（1）将告诉飞机在发生火炬之前尽可能多地排空空气。



控制方法

在着陆进近过程中，自动驾驶仪需要平衡要求的空速（由TECS\_LAND\_ARSPD设置）和要求的滑翔坡度和着陆位置（由前一个航点和最终着陆点设定）。默认配置试图平衡这两个要求，但对于某些飞机，您可能需要优先考虑。



空速控制与高度控制的优先级使用TECS\_LAND\_SPDWGT参数进行设置。值1（默认）意味着两者之间的平衡。接近于2的值给出空速的更高优先级，而接近于零的值给予高度控制更高的优先级。例如，如果您以接近失速速度的速度降落，则您可能希望将空速控制放在最重要的位置。为此，应将TECS\_LAND\_SPDWGT设置为接近2的值，如1.9。



如果你想在着陆的时候想要的是精确的，那么你应该把TECS\_LAND\_SPDWGT设置为一个较小的数字，比如0.2甚至0.0。在这种情况下，飞机仍然会尝试使用油门来达到目标​​着陆的空速，但是它不会试图用俯仰来控制空速。



如果您正在降落滑翔机（或者没有电机的飞机），那么您应该将TECS\_LAND\_SPDWGT设置为2.0，这样空速就是优先级，空距将用于控制空速。



在大多数情况下，-1的值给出最好的结果。这个特殊的值会在着陆过程中自动调整数值，从正常的TECS\_SPDWEIGHT值降到零点。在进近的过程中，您保持良好的空速，但在您登陆的时候，重点是更准确的着陆。



控制flare

着陆的最后阶段被称为“flare”。在flare期间，飞机试图保持沿着最后一个航点和着陆航点之间的航线，并且仅使用目标下降速度来控制其高度。一旦flare开始，油门被“禁用” - 设置为THR\_MIN和零之间的某个值。



飞行控制器在flare中的主要工作是尝试达到TECS\_LAND\_SINK参数中指定的下降速率。默认为0.25米/秒，对大多数飞行器来说是一个合理的降落垂直速度。为了达到这个速度，TECS控制器只有在马达被迫归零时才使用桨距控制。



影响飞机达到理想下降速度能力的主要参数是LAND\_PITCH\_CD，TECS\_LAND\_DAMP和主俯仰调整参数。



LAND\_PITCH\_CD参数设置耀斑中的最小俯仰目标（以厘米为单位）。这个参数是非常专门设计的，目的是为了防止在接地时飞机的机头过低，造成损坏起落架或破坏螺旋桨的问题。对于大多数飞机来说，这应该是一个小正数（如300，意思是3度），但对于一些腹部着陆的飞机，可以设成小负数，如果flare时飞机远离地面，将失速。

请注意，由于TECS控制器试图控制下降速率，因此飞机的实际俯仰角可能比LAND\_PITCH\_CD高很多。如果TECS\_PITCH\_MAX参数非零，则最大俯仰由TECS\_PITCH\_MAX参数控制，否则由LIM\_PITCH\_MAX参数控制。

TECS\_LAND\_DAMP参数是过程中桨距控制的阻尼常数。数字越大，俯仰要求变化越慢。这个参数可以用来减少熄火发生时突然发生俯仰变化的问题。

### Flare之后

飞机flare后继续导航，但零油门。导航方向是从最后一个航点通过着陆点向前外推的一条线。请注意，导航滚动将被限制为LEVEL\_ROLL\_LIMIT（默认为5度）以防止机翼打击，所以如果存在显着的横风，则飞机可能无法保持精确的路径。

如果您的飞机长时间持续着陆（可能出于各种原因），那么您可以调整TECS\_LAND\_SRC以强迫失速（负）或降低（正）。此值会调整您的TECS\_LAND\_SINK与距离LAND点的距离成比例。这有助于确保您从LAND点合理的距离。

注意

长期着陆的可能原因包括地面效应使得飞机有更多的升力，因为它靠近地面，或者只是飞机飞得很快。

当飞机停止移动LAND\_DISARMDELAY秒（默认20秒）时，它将解锁电机。或者，可以通过设置LAND\_THEN\_NEUTRL触发LAND\_DISARMDELAY，从而禁用伺服移动。

### 使用测距仪

如果你已经为你的飞机安装了测距仪，那么你可以使用它来更准确的着陆控制。要允许测距仪用于着陆，您需要将RNGFND\_LANDING参数设置为1。

当使用测距仪着陆时，测距仪给出的高度仅用于着陆进近和确定眩光点，其目的是使飞机更准确地跟随下滑道并在正确的时间闪光。

注意

测距仪的效果可能取决于您飞过的地面，所以最好在飞行模式（如FBWA）中进行一些低通，然后检查日志以检查测距仪是否正常工作。

另外请注意，如果您有更远距离的测距仪，那么将测距仪的最小范围设置为远高于零是个好主意。例如，脉冲激光雷达的典型范围超过40米，当它读取错误的读数往往读取范围小于1米。将RNGFND\_MIN\_CM设置为150将丢弃1.5米以下的任何测距仪读数，并将极大地提高激光雷达着陆的鲁棒性。

## 改善着陆

一个好的着陆的关键是自动驾驶知道它离地面有多远。使用默认设置，可用于检测高度的唯一传感器是晴雨表。不幸的是，气压计有三种主要的误差：

气压变化引起的气压漂移

由于自动驾驶仪电子部件的温度变化而造成的气压漂移

气压计周围气流的局部压力变化引起的气压误差

良好的自动着陆的理想设置是激光雷达。激光雷达可以非常准确地测量到地面的距离，而不会发生漂移。如果您安装了激光雷达，则可以使用RNGFND\_LANDING = 1进行着陆。

如果激光雷达没有安装，那么可以采取一些措施来尽量减少自动着陆的气压误差问题

在电子设备加热后执行气压计校准。 Pixhawk最简单的方法是用安全开关解除飞机的飞行状态。当飞机撤防时，它假定它在地面上，并将气压计调到当前的压力。

尽量避免直接通过自动驾驶仪的气流，这可能导致速度相关的压力变化

飞行时间缩短，可以减少更换空气的时间。检查你的日志，看看是否一直在零高度着陆

在飞机降落的情况下，它也可以很好的设置着浅间距的着陆（在LAND\_PITCH\_CD中），并设置一个稍微高一点的高度，只有当你的失速速度足够低，滑行一段时间才能可靠地工作，这将是唯一的工作。

使用DO\_LAND\_START

有时触发自动着陆作为RTL（返回到启动）的一部分是有用的。要做到这一点，你需要做两件事情：

在你的着陆序列开始之前，向你的任务添加一个DO\_LAND\_START任务物品

将RTL\_AUTOLAND参数设置为1或2

它的工作方式是当飞机进入RTL时，它检查参数RTL\_AUTOLAND是否被设置为1或2.如果是，则搜索当前任务DO\_LAND\_START类型的任务项目。如果找到了，那么飞机将自动进入自动模式并着陆，从DO\_LAND\_START标记之后的任务部分开始。

确切的行为取决于RTL\_AUTOLAND值：

如果RTL\_AUTOLAND = 1，那么飞机将首先像往常一样RTL，然后当它开始绕回返回点（回家或集合点）时，它将在DO\_LAND\_START和陆地之后切换到AUTO任务

如果RTL\_AUTOLAND = 2，则飞机将完全绕过RTL并直接进入着陆序列。

你可以选择在你的任务中包含多个DO\_LAND\_START任务物品。如果这样做，则使用DO\_LAND\_START任务项目的纬度/经度来选择使用哪个着陆序列。使用最接近当前位置的DO\_LAND\_START。如果您针对不同的风况或不同的地区有多个着陆序列，这可能会很有用。



### 如何中止自动着陆

提供一个着陆中止机制，允许您以安全，受控和预期的方式中止着陆顺序。自定义中止行为可以预先编程作为任务的一部分，或者您可以使用默认的中止机制。要启用此功能，请设置参数LAND\_ABORT\_THR = 1。

这个功能有三个步骤：＃。触发中止＃。中止＃期间的行为。中止完成后的任务状态。

步骤1）中止降落触发

这是触发自动着陆中止的三种方式。他们都只能在自动模式下工作，并且正在执行LAND航点任务项目：

使用GCS发送MAV\_CMD\_DO\_GO\_AROUND命令。 Mission Planner在FlightData Actions标签上有一个标记为“Abort Landing”的按钮。

RC输入油门&gt; 90％。这会在AUTO模式下触发一个中止。油门只需要很短的时间来触发它。不要忘记降低它！

模式改变。对于人体飞行着陆中止，您可以将自动模式切换到例如MANUAL / STABILIZE / FBWA，然后根据需要安全地导航飞行器。使用此方法将跳过中止行为步骤2，因为它正在手动完成。当切换回AUTO时，任务将按照下面的步骤3所述继续。

步骤2）中止飞行行为

中止行为具有默认配置，不需要预先计划的任务。默认的中止行为是模拟自动起飞：调高至少10度，并将油门设置为TKOFF\_THR\_MAX并保持航向，直到达到目标高度30米。可以改变俯仰和高度以允许定制的行为。

俯仰最小。如果在这次任务中执行过NAV\_TAKEOFF，那么相同的音高将在这里被重新使用。

目标高度。如果NAV\_LAND参数1&gt; 0，那么它被用作以米为单位的目标高度。否则，如果NAV\_TAKEOFF曾经执行过这个任务，那么相同的高度将在这里被重新使用。

如果放弃触发器是通过模式改变的话，这个步骤将被跳过，因为假定飞行员手动地接管并且以他们选择的音高和油门飞行到安全高度。

步骤3）中止着陆完成后的任务状态

一旦中止土地完成，通过达到目标高度或切换回AUTO，任务指数将会改变，您将不再执行NAV\_LAND命令。使命指数将改变为这三个选项之一，并按此顺序进行检查：

如果NAV\_LAND任务项目后面是任务项目CONTINUE\_AND\_CHANGE\_ALT且param1 = 0或1，则任务索引将增加一次该命令并像正常一样执行。这之后可以进行任何定制的任务行为的进一步的中止任务计划。

否则，如果在任务中有DO\_LAND\_START，则跳转到该索引。

否则任务指数减一次是NAV\_LAND之前的索引。这将确保重复相同的着陆方法。

逆推着陆

一些ESC允许反向。在螺旋桨上反向使用时，会产生一个负向推力，可以用来降低空速。在陡峭着陆的过程中，这种方法可以用来保持稳定的低速空速，让您更轻松准确地降落。要使用此功能，强烈建议使用空速传感器和测距仪（见上文）以获得准确的高度。

注意

从Plane v3.5.1开始，反向推力着陆是可用的。

关键参数

控制反推着陆的关键参数除了1.1中列出的外，还有：

LAND\_PF\_ALT

LAND\_PF\_SEC

LAND\_PF\_ARSPD

USE\_REV\_THRUST

TECS\_APPR\_SMAX

RC3\_TRIM

THR\_MIN

ESC（电子调速器）

硬件选择和编程

大多数电调可以正反转运行，但这通常不是股票功能，可能需要重新编程才能完成。 任何SimonK和BLHeli兼容的ESC都可以flare以支持反向推力。

这里是关于BLHeli兼容的信息。

硬件配置

通过改变它的中性点来配置您的ESC反向推力。许多ESC需要定制固件来实现这一点。搜索谷歌或您的ESC的mfgr有关如何配置您的特定ESC的说明。



设置这些：

最小PWM到1000，中间到1500，最大到2000。

THR\_MIN为负值，例如-100。接下来将RC3\_TRIM（或其他RCx映射到通过RCMAP\_THROTTLE进行调节）设置为ESC的中间值。

确定您的最大下滑角度

对于陡峭的着陆方法，限制是你能保持你想要的空速。这取决于您的飞机创造反向推力（电机+支撑推力）的能力及其对减速（飞机质量）的阻力。在许多情况下，极度陡峭是不必要的，但是可能的。超大型电机和轻型飞机可以像60度一样陡峭。



要确定最陡峭的接近角度，请将TECS\_APPR\_SMAX设置得非常高，以免限制您（例如99）。接下来，计划一个比正常的方法更陡峭的任务（尝试15度，从那里上去）。在进场时注意你的空速 - 飞机应该能够保持TECS\_LAND\_ARSPD而不超过可用倒车油门范围的75％。如果不是这样，那么你的飞机的负推力质量比就太高了。



请记住，无论您决定的最大值如何，在所有的风力条件下都是不可接受的。保持可重复性最好保守一点。

设置前眩光

在安装了测距仪和空速传感器之前，在闪光点前，我们将获得精确的空速和高度读数。这给了我们一个很好的想法，我们的动力和稳定的“初始条件”，以最后的耀斑。将LAND\_PF\_ALT（或LAND\_PF\_SEC）设置为相当高的点（例如10米）并从那里调整。接下来将LAND\_PF\_ARSPD设置为恰好高于您的失速速度的值。

当达到LAND\_PF\_ALT时，空速需求将立即从TECS\_LAND\_ARSPD变为LAND\_PF\_ARSPD。这将导致它通过增加的反向推力而踩下制动器，从而使空速减小到期望的空速。

诀窍是将LAND\_PF\_ALT设置为达到LAND\_PF\_ARSPD的高度，然后杀死LAND\_FLARE\_ALT处的油门（发生在一个稍低的高度 - 约1米或2米）。

例如，TECS\_LAND\_ARSPD = 15，LAND\_PF\_ARSPD = 12，LAND\_PF\_ALT = 12，LAND\_FLARE\_ALT = 2。根据您的斜率，飞机质量和电机+推进器推力，您预计飞机从15m / s减速到12m / s空速，同时降低10m到2m。这些是调整的关键参数，以确保低于2米高度的平稳和缓慢的flare。

Flare

现在，您正在以稳定和可预测的空速开始Flare，控制Flare更容易。如果你已经调整了你的flare，而不是反向推力的话，你会想要调整它。您会注意到您的广告调整速度要慢得多。你之前必须做的调整和妥协更容易处理。

确定您的飞机的实际失速速度

除非你真的知道你在做什么，否则摊位速度很难估计。传统上，要确定这个真正的价值，你需要慢慢地降低你的空速，直到你失速，但是这个麻烦的问题是，现在你有一架失速的飞机从天上掉下来。

借助LAND\_PF\_ALT和LAND\_PF\_ARSPD，您可以将您的失速速度降到更低的水平。要知道空速在什么时候停止，当您的机翼失去升力并通过比较实际的滚转（CTUN.Roll）和所需的滚动来检查您的数据闪存日志（SD卡上的\* .bin）的空速（ARSP.Airspeed） （CTUN.NavPitch）分歧。

现在，您正在以稳定和可预测的空速开始闪光，控制耀斑更容易。如果你已经调整了你的flare，而不是反向推力的话，你会想要调整它。您会注意到您的广告调整速度要慢得多。你之前必须做的调整和妥协更容易处理。

确定您的飞机的实际失速速度

除非你真的知道你在做什么，否则摊位速度很难估计。传统上，要确定这个真正的价值，你需要慢慢地降低你的空速，直到你失速，但是这个麻烦的问题是，现在你有一架失速的飞机从天上掉下来。

借助LAND\_PF\_ALT和LAND\_PF\_ARSPD，您可以将您的失速速度降到更低的水平。要知道空速在什么时候停止，当您的机翼失去升力并通过比较实际的滚转（CTUN.Roll）和所需的滚动来检查您的数据闪存日志（SD卡上的\* .bin）的空速（ARSP.Airspeed） （CTUN.NavPitch）分歧。

