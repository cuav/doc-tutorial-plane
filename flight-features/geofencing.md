## 在飞机上的地理围栏

---

平面中的地理围栏支持允许您在要飞行的区域周围设置地理围栏，指定为GPS位置的封闭多边形以及最小和最大高度。

注意

在固定翼上，必须为地理围栏参数绘制栅栏多边形。在“直升机”中，您可以指定一个没有围栏多边形的最大围栏高度，并且“直升机”将遵守此规定，但“固定翼”要求您为包括最大/最小值ALT在内的任何围栏参数绘制多边形。

启用保护时，如果您的飞机离开围栏区域，则会切换到“引导”模式，然后飞回预定义的返回点，然后在那里闲逛，准备再次接管。然后，您可以使用遥控器上的开关或使用地面控制站（GCS）中的命令来取回控制权。

用于R C控制训练

地理围栏的主要用途之一是教自己（或其他人）使用无线电遥控飞机。当你有一个正确配置的地理围栏，几乎不会出现地理围栏失效的情况，所以是非常可靠和安全的设置。

地理围栏可以与任何APM飞行模式相结合。所以对于初学者来说，你可以将它与稳定的飞行模式（如STABILIZE或FBWA）结合起来。一旦飞行员获得了一些信心，就可以将其与手动模式结合起来，从而直接控制飞机，并允许进行最有趣的特技飞行。当以这种方式使用时，APM完全不受控制，只是将控制器直接传递给伺服系统，并且只有在您离开围栏区域或超出定义的高度范围时才能进行控制。

### 用于阻拦

---

在完全自主操作期间，围栏可以用作故障安全措施以确保飞机停留在预期的飞行区域内。在完全自主操作期间，使用FENCE\_AUTOENABLE参数，飞机在起飞完成后将自动启用围栏，并在到达降落点时自动禁用围栏。将FENCE\_AUTOENABLE参数设置为1以使用此功能。有关设置登陆和起飞航点的详细信息，请参阅规划航点和事件任务页面。

当然，围栏也可以用于半自主任务中的阻拦（例如起飞和/或着陆是手动的任务），围栏仍然可以通过R / C发射器或GCS控制 - FENCE\_AUTOENABLE是可选的。

### 设置地理围栏

要在Plane中设置地理围栏，您需要配置几件事情：

*  围栏的边界，作为一组GPS点

* 对到达围栏边界采取的行动

* 返回点的位置;请注意，您可以选择使用FENCE\_RET\_RALLY参数让飞机返回最近的集合点而不是围栏返回点。

*  围栏区域的最小和最大高度

* 你将使用什么RC通道来启用地理围栏（如果有的话）

* 当您想要配置围栏在自动起飞后自动启用并在自动着陆后自动禁用时，可选设置（FENCE\_AUTOENABLE）

* 在突破围栏之后，你想如何收回控制权

这些都可以使用APM Mission Planner进行设置。

在设置围栏边界时，您必须遵守一些规则：

*  返回点必须在围栏边界内

* 围栏边界必须完全封闭。这意味着它必须至少有4个点，最后一点必须与第一个点相同

* 边界最多可以有18个点

#### 如果您使用APM plnner设置围栏，应确保遵循这些规则。

请记住，在制作围栏边界时，您的飞机撞击围栏时会有一些动量，并需要时间返回到返回点。对于像SkyWalker这样的飞机，我们建议在你想飞的地方的真实边界内增加一个大约30米的安全边界。最低高度也是一样 - 你需要做足够的高度以使APM有时间从快速跳水中恢复过来。您需要多少保证取决于飞机的飞行特性。

除围栏边界外，以下MAVLink参数还可以控制地理围栏行为：

*  FENCE\_ACTION - 对突破围栏采取的行动。默认为零，禁用地理围栏。将其设置为1，以启用地理围栏并飞向围栏突破处的返回点。设置为2向GCS报告违规行为，但不采取其他行动。设置为3使飞机在违规时返回到飞机的返回点，但飞行员在这种情况下将保持手动油门控制。

* FENCE\_MINALT - 以米为单位的最小高度。如果这是零，那么你将不会有最低的高度。

* FENCE\_MAXALT - 以米为单位的最大高度。如果这是零，那么你将不会有最高的高度。

* FENCE\_CHANNEL - 用于启用地理围栏的RC输入通道。默认为零，禁用地理围栏。您应该将其设置为一个备用RC输入通道，该通道连接到变送器上的两位开关。当此通道高于1750的PWM值时，屏蔽将被启用。如果您的发射器支持此功能，则启用此通道（每隔几秒发出一声蜂鸣）时启用声音反馈也是一个好主意。

* FENCE\_TOTAL - 栅栏中的点数（返回点加上封闭的边界）。这应该由计划者在创建围栏时为您设置。

* FENCE\_RETALT - 飞机在返回点和在返航点游荡时的飞行高度（以米为单位）。请注意，当FENCE\_RET\_RALLY设置为1时，此参数将被忽略，并使用最接近的拉力点的游标高度。如果此参数为零且FENCE\_RET\_RALLY也为零，则使用FENCE\_MAXALT和FENCE\_MINALT参数的中点作为返回高度。

* FENCE\_AUTOENABLE - 如果设置为1，则飞机将在禁用围栏的情况下启动。自主起飞完成后，围栏将自动启用。当自主任务到达着陆点时，围栏自动禁用。

* FENCE\_RET\_RALLY - 如果设置为1，当围栏被破坏时，飞机将前往最近的集合点而不是围栏返回点。请注意，集合点的空闲高度被用作返回高度。

注意

集结点可以在地理围栏之外，但不建议这样做。如果在地理围栏外有一个集结点，则需要使用FENCE\_CHANNEL禁用地理围栏，然后才能再次控制飞机，否则飞机将停留在“引导”模式，以避免绕过集合点。一旦地理围栏被禁用，您应该将飞机放回地理围栏内，然后重新启用它。

一个额外的参数可能有助于充分利用地理围栏。当您突破围栏时，飞机将切换到导航模式并飞回返回点（或者如果FENCE\_RET\_RALLY设置为1，则返回最近的集结点）。一旦你回到围栏边界内，你就可以再次控制，你需要告诉APM你想要控制。您可以通过以下三种方式之一来完成此操作：

使用遥控器上的APM模式开关更改模式，或通过Mission Planner GCS（例如，从GUIDED模式更改为AUTO模式）更改模式。

使用FENCE\_CHANNEL通道禁用和重新启用地理围栏

将RST\_SWITCH\_CH MAVLink参数设置为连接到弹簧加载开关的另一个双位置通道。 RST\_SWITCH\_CH参数默认为零，禁用它。如果您将其设置为频道，那么您可以使用此通道切换器在突破围栏后收回控制权。

如果不是完全自主飞行，我发现使用RST\_SWITCH\_CH是地理围栏的最佳选择，因为这意味着APM在整个飞行过程中启用了围栏，并且您不会通过切换模式来改变任何行为。但它确实占用了另一个通道，所以有些人可能没有足够的通道来使用它。



